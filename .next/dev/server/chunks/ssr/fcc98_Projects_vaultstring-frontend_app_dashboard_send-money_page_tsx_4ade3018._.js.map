{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gondwe/Desktop/VaultString/Projects/vaultstring-frontend/app/dashboard/send-money/page.tsx"],"sourcesContent":["// app/dashboard/send-money/page.tsx\n'use client';\n\nimport { useEffect, useState } from 'react';\nimport { apiFetch, isAuthenticated } from '@/src/lib/api/api-client';\nimport { useAuth } from '@/src/context/AuthContext';\n\nexport default function SendMoneyPage() {\n  const { user } = useAuth();\n  const [form, setForm] = useState({ receiver_id: '', amount: '', currency: 'MWK', description: '', channel: 'web', category: 'transfer' });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<any | null>(null);\n\n  useEffect(() => {\n    const cc = String(user?.countryCode || '').toUpperCase();\n    if (cc === 'CN') setForm((f) => ({ ...f, currency: 'CNY' }));\n    else if (cc === 'MW') setForm((f) => ({ ...f, currency: 'MWK' }));\n  }, [user?.countryCode]);\n\n  const onChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setForm((f) => ({ ...f, [name]: value }));\n  };\n\n  const onSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setResult(null);\n    try {\n      if (!isAuthenticated()) throw new Error('Please login to send a payment');\n      const payload = {\n        receiver_id: form.receiver_id,\n        amount: Number(form.amount),\n        currency: form.currency,\n        description: form.description,\n        channel: form.channel,\n        category: form.category,\n      };\n      const res = await apiFetch('/payments/initiate', { method: 'POST', body: JSON.stringify(payload) });\n      setResult(res);\n    } catch (e: any) {\n      setError(e?.data?.error || e?.message || 'Payment failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <h1 className=\"text-2xl font-semibold\">Send Money</h1>\n      <p className=\"text-muted-foreground\">Initiate cross-border transfers and payouts here.</p>\n\n      <form onSubmit={onSubmit} className=\"bg-card text-card-foreground rounded-xl border p-6 space-y-4 max-w-xl\">\n        <div>\n          <label className=\"text-sm text-muted-foreground\">Receiver ID (UUID)</label>\n          <input name=\"receiver_id\" value={form.receiver_id} onChange={onChange} className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\" placeholder=\"e.g. user UUID\" required />\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"text-sm text-muted-foreground\">Amount</label>\n            <input name=\"amount\" value={form.amount} onChange={onChange} type=\"number\" min=\"0\" step=\"0.01\" className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\" placeholder=\"0.00\" required />\n          </div>\n          <div>\n            <label className=\"text-sm text-muted-foreground\">Currency</label>\n            <select name=\"currency\" value={form.currency} onChange={onChange} className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\">\n              {String(user?.countryCode || '').toUpperCase() === 'CN' ? (\n                <>\n                  <option value=\"CNY\">CNY</option>\n                </>\n              ) : (\n                <>\n                  <option value=\"MWK\">MWK</option>\n                </>\n              )}\n            </select>\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"text-sm text-muted-foreground\">Channel</label>\n            <select name=\"channel\" value={form.channel} onChange={onChange} className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\">\n              <option value=\"web\">Web</option>\n              <option value=\"mobile\">Mobile</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"text-sm text-muted-foreground\">Category</label>\n            <input name=\"category\" value={form.category} onChange={onChange} className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\" placeholder=\"e.g. transfer\" />\n          </div>\n        </div>\n        <div>\n          <label className=\"text-sm text-muted-foreground\">Description</label>\n          <input name=\"description\" value={form.description} onChange={onChange} className=\"mt-1 w-full border rounded-md px-3 py-2 bg-background\" placeholder=\"Payment description\" />\n        </div>\n\n        <button type=\"submit\" disabled={loading} className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md\">\n          {loading ? 'Processing...' : 'Send Payment'}\n        </button>\n      </form>\n\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800 rounded-xl p-4 max-w-xl\">{error}</div>\n      )}\n\n      {result?.transaction && (\n        <div className=\"bg-card text-card-foreground rounded-xl border p-6 max-w-xl\">\n          <h2 className=\"text-xl font-semibold mb-4\">Payment Result</h2>\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between\"><span className=\"text-muted-foreground\">Reference</span><span className=\"font-mono\">{String(result.transaction.reference)}</span></div>\n            <div className=\"flex justify-between\"><span className=\"text-muted-foreground\">Status</span><span className=\"font-semibold\">{String(result.transaction.status)}</span></div>\n            <div className=\"flex justify-between\"><span className=\"text-muted-foreground\">Amount</span><span className=\"font-semibold\">{String(result.transaction.amount)}</span></div>\n            <div className=\"flex justify-between\"><span className=\"text-muted-foreground\">Currency</span><span>{String(result.transaction.currency)}</span></div>\n            <div className=\"flex justify-between\"><span className=\"text-muted-foreground\">Converted</span><span>{String(result.transaction.converted_amount)} {String(result.transaction.converted_currency)}</span></div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}