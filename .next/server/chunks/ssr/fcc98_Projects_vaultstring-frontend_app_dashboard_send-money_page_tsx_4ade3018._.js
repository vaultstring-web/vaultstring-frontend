module.exports=[19465,a=>{"use strict";var b=a.i(22035),c=a.i(74283);function d(a,b){return(...a)=>{try{return b(...a)}catch{throw Error(void 0)}}}let e=d(0,c.useTranslations);d(0,c.useFormatter);var f=a.i(41691),g=a.i(27399);function h({from:a,to:c,amount:d,rate:e,converted:h,fee:i,loading:j,error:k}){let l=String(a).toUpperCase(),m=String(c).toUpperCase();return(0,b.jsxs)(f.Card,{className:"border-slate-200 shadow-sm",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3 border-b border-slate-100 bg-slate-50/50",children:(0,b.jsx)(f.CardTitle,{className:"text-base font-semibold text-slate-800",children:"Exchange Rate Preview"})}),(0,b.jsx)(f.CardContent,{className:"pt-4",children:k?(0,b.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg border border-red-100",children:k}):(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Exchange Rate"}),(0,b.jsx)("span",{className:"font-mono font-medium text-slate-700",children:j?"...":e?`1 ${l} = ${e.toFixed(4)} ${m}`:"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Converted Amount"}),(0,b.jsx)("span",{className:"font-bold text-slate-900",children:j?"...":null!==h?(0,g.formatCurrency)(h,m):"—"})]}),null!==i&&(0,b.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100 mt-2",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Fees (Included)"}),(0,b.jsx)("span",{className:"font-medium text-amber-600",children:j?"...":(0,g.formatCurrency)(i,l)})]}),null!==h&&(0,b.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100 mt-2",children:[(0,b.jsx)("span",{className:"text-slate-500 font-medium",children:"Recipient Gets"}),(0,b.jsx)("span",{className:"font-bold text-emerald-600 text-lg",children:j?"...":(0,g.formatCurrency)(h,m)})]})]})})]})}var i=a.i(78807),j=a.i(60906),k=a.i(74728),l=a.i(32041),m=a.i(11847),n=a.i(30829),o=a.i(42454),p=a.i(97529);let q=(0,p.default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var r=a.i(22967),s=a.i(41438),t=a.i(23723),u=a.i(10648),v=a.i(97687);let w=(0,p.default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),x=(0,p.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var y=a.i(48186);let z=(a,b)=>{let c=`VaultString Wallet (${b.toFixed(2)} ${a})`;return"MWK"===a?[{value:"wallet_balance",label:c,channel:"wallet",icon:v.Wallet},{value:"airtel_money",label:"Airtel Money",channel:"mobile_money",icon:w},{value:"tnm_mpamba",label:"TNM Mpamba",channel:"mobile_money",icon:w},{value:"nbm",label:"National Bank of Malawi",channel:"bank",icon:x},{value:"standard_bank_mw",label:"Standard Bank Malawi",channel:"bank",icon:x},{value:"fdh_bank",label:"FDH Bank",channel:"bank",icon:x},{value:"nbs_bank",label:"NBS Bank",channel:"bank",icon:x},{value:"first_capital_bank",label:"First Capital Bank",channel:"bank",icon:x},{value:"ecobank_mw",label:"Ecobank Malawi",channel:"bank",icon:x},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card",icon:y.CreditCard}]:"CNY"===a?[{value:"wallet_balance",label:c,channel:"wallet",icon:v.Wallet},{value:"alipay",label:"Alipay",channel:"mobile_money",icon:w},{value:"wechat_pay",label:"WeChat Pay",channel:"mobile_money",icon:w},{value:"icbc",label:"ICBC",channel:"bank",icon:x},{value:"ccb",label:"China Construction Bank",channel:"bank",icon:x},{value:"boc",label:"Bank of China",channel:"bank",icon:x},{value:"abc",label:"Agricultural Bank of China",channel:"bank",icon:x},{value:"cmb",label:"China Merchants Bank",channel:"bank",icon:x},{value:"unionpay_card",label:"UnionPay Card",channel:"card",icon:y.CreditCard}]:"ZMW"===a?[{value:"wallet_balance",label:c,channel:"wallet",icon:v.Wallet},{value:"airtel_money_zm",label:"Airtel Money Zambia",channel:"mobile_money",icon:w},{value:"mtn_money_zm",label:"MTN Mobile Money",channel:"mobile_money",icon:w},{value:"zamtel_money",label:"Zamtel Money",channel:"mobile_money",icon:w},{value:"zanaco",label:"Zanaco",channel:"bank",icon:x},{value:"stanbic_zm",label:"Stanbic Bank Zambia",channel:"bank",icon:x},{value:"absa_zm",label:"ABSA Zambia",channel:"bank",icon:x},{value:"atlas_mara",label:"Atlas Mara",channel:"bank",icon:x},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card",icon:y.CreditCard}]:[{value:"wallet_balance",label:"VaultString Wallet",channel:"wallet",icon:v.Wallet},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card",icon:y.CreditCard},{value:"wire_transfer",label:"Bank Wire Transfer",channel:"bank",icon:x}]};function A({currency:a,walletBalance:c,value:d,onChange:e}){let f=(0,r.useMemo)(()=>z(a,c),[a,c]);return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Funding Source"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(a=>{let c=a.icon,f=d===a.value;return(0,b.jsxs)("div",{onClick:()=>e(a.value),className:`
                relative flex items-center p-3 rounded-xl border cursor-pointer transition-all duration-200
                ${f?"border-indigo-600 bg-indigo-50 ring-1 ring-indigo-600 shadow-sm":"border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}
              `,children:[(0,b.jsx)("div",{className:`
                h-10 w-10 rounded-full flex items-center justify-center shrink-0 mr-3
                ${f?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}
              `,children:(0,b.jsx)(c,{size:20})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:`font-medium text-sm ${f?"text-indigo-900":"text-slate-900"}`,children:a.label}),(0,b.jsx)("div",{className:"text-xs text-slate-500 capitalize",children:a.channel.replace("_"," ")})]}),f&&(0,b.jsx)("div",{className:"absolute top-2 right-2 h-2 w-2 rounded-full bg-indigo-600"})]},a.value)})})]})}function B({targetCurrency:a,value:c,onChange:d}){let e=(0,r.useMemo)(()=>"CNY"===a?[{value:"wallet_topup_cny",label:"Wallet Top-up (CNY)",channel:"wallet",icon:v.Wallet},{value:"alipay",label:"Alipay",channel:"mobile_money",icon:w},{value:"wechat_pay",label:"WeChat Pay",channel:"mobile_money",icon:w},{value:"icbc",label:"ICBC",channel:"bank",icon:x},{value:"ccb",label:"China Construction Bank",channel:"bank",icon:x},{value:"boc",label:"Bank of China",channel:"bank",icon:x},{value:"abc",label:"Agricultural Bank of China",channel:"bank",icon:x},{value:"cmb",label:"China Merchants Bank",channel:"bank",icon:x}]:"MWK"===a?[{value:"wallet_topup_mwk",label:"Wallet Top-up (MWK)",channel:"wallet",icon:v.Wallet},{value:"airtel_money",label:"Airtel Money",channel:"mobile_money",icon:w},{value:"tnm_mpamba",label:"TNM Mpamba",channel:"mobile_money",icon:w},{value:"nbm",label:"National Bank of Malawi",channel:"bank",icon:x},{value:"standard_bank_mw",label:"Standard Bank Malawi",channel:"bank",icon:x},{value:"fdh_bank",label:"FDH Bank",channel:"bank",icon:x},{value:"nbs_bank",label:"NBS Bank",channel:"bank",icon:x}]:"ZMW"===a?[{value:"wallet_topup_zmw",label:"Wallet Top-up (ZMW)",channel:"wallet",icon:v.Wallet},{value:"airtel_money_zm",label:"Airtel Money Zambia",channel:"mobile_money",icon:w},{value:"mtn_money_zm",label:"MTN Mobile Money",channel:"mobile_money",icon:w},{value:"zamtel_money",label:"Zamtel Money",channel:"mobile_money",icon:w},{value:"zanaco",label:"Zanaco",channel:"bank",icon:x},{value:"stanbic_zm",label:"Stanbic Bank Zambia",channel:"bank",icon:x},{value:"absa_zm",label:"ABSA Zambia",channel:"bank",icon:x}]:[{value:"wire_transfer",label:"Bank Wire Transfer",channel:"bank",icon:x},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card",icon:y.CreditCard}],[a]);return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Payout Method"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:e.map(a=>{let e=a.icon,f=c===a.value;return(0,b.jsxs)("div",{onClick:()=>d(a.value),className:`
                relative flex items-center p-3 rounded-xl border cursor-pointer transition-all duration-200
                ${f?"border-indigo-600 bg-indigo-50 ring-1 ring-indigo-600 shadow-sm":"border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}
              `,children:[(0,b.jsx)("div",{className:`
                h-10 w-10 rounded-full flex items-center justify-center shrink-0 mr-3
                ${f?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}
              `,children:(0,b.jsx)(e,{size:20})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:`font-medium text-sm ${f?"text-indigo-900":"text-slate-900"}`,children:a.label}),(0,b.jsx)("div",{className:"text-xs text-slate-500 capitalize",children:a.channel.replace("_"," ")})]})]},a.value)})})]})}var C=a.i(58212);function D({result:a,amount:c,currency:d,receiverName:e,onReset:f}){return(0,b.jsx)("div",{className:"bg-emerald-50 border border-emerald-200 text-emerald-800 px-6 py-6 rounded-xl shadow-md animate-in fade-in zoom-in-95",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,b.jsx)("div",{className:"h-16 w-16 bg-emerald-100 rounded-full flex items-center justify-center mb-4 text-emerald-600",children:(0,b.jsx)(C.CheckCircle2,{size:32})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-emerald-900 mb-2",children:"Payment Successful!"}),(0,b.jsx)("p",{className:"text-emerald-700 mb-4",children:"Your transaction has been processed securely."}),(0,b.jsxs)("div",{className:"w-full bg-white rounded-lg border border-emerald-100 p-4 text-left space-y-2 mb-4",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-emerald-600",children:"Transaction ID"}),(0,b.jsxs)("span",{className:"font-mono font-medium",children:[a.transaction_id?.substring(0,8),"..."]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-emerald-600",children:"Receiver"}),(0,b.jsx)("span",{className:"font-medium",children:a.receiver_name||e||a.receiver_wallet_number})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-emerald-600",children:"Amount Sent"}),(0,b.jsx)("span",{className:"font-bold",children:(0,g.formatCurrency)(c,d)})]})]}),(0,b.jsx)(l.Button,{variant:"outline",className:"w-full border-emerald-200 text-emerald-700 hover:bg-emerald-100 hover:text-emerald-800",onClick:f,children:"Send Another Payment"})]})})}function E({value:a,onChange:c,loading:d,suggestions:e,showSuggestions:f,setShowSuggestions:g,onSelectSuggestion:h,receiverName:i}){return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Recipient Wallet Number"}),(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)(v.Wallet,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),(0,b.jsx)(j.Input,{name:"receiver_id",value:a,onChange:c,placeholder:"Enter 16-digit Wallet Number",required:!0,className:"pl-10 text-slate-900 border-slate-200 focus:border-indigo-500 focus:ring-indigo-500 h-11",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,inputMode:"numeric",maxLength:16}),(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:d?(0,b.jsx)(n.Loader2,{size:16,className:"animate-spin text-slate-400"}):null}),f&&e.length>0&&(0,b.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-200 max-h-60 overflow-y-auto",children:[(0,b.jsxs)("div",{className:"p-2 bg-slate-50 border-b border-slate-100 text-xs font-semibold text-slate-500 uppercase tracking-wider flex justify-between items-center",children:[(0,b.jsx)("span",{children:"Suggested Receivers"}),(0,b.jsx)("span",{className:"text-[10px] bg-slate-200 px-1.5 py-0.5 rounded text-slate-600",children:"Enter more digits to refine"})]}),e.map((a,c)=>(0,b.jsxs)("button",{type:"button",onClick:()=>h(a.address),className:"w-full text-left p-3 hover:bg-indigo-50 transition-colors flex items-center gap-3 border-b border-slate-50 last:border-0",children:[(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold shrink-0",children:a.name.charAt(0).toUpperCase()}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-slate-500 font-mono flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.address}),(0,b.jsx)("span",{className:"bg-slate-100 px-1.5 rounded text-slate-600",children:a.currency})]})]})]},c))]}),i&&(0,b.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:(0,b.jsxs)("div",{className:"p-4 flex items-center gap-4 bg-gradient-to-r from-indigo-50 to-white",children:[(0,b.jsx)("div",{className:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold text-lg shrink-0 border-2 border-white shadow-sm",children:i.charAt(0).toUpperCase()}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-xs text-indigo-500 font-semibold uppercase tracking-wider mb-0.5 flex items-center gap-1",children:[(0,b.jsx)(C.CheckCircle2,{size:12})," Verified Receiver"]}),(0,b.jsx)("div",{className:"text-lg font-bold text-slate-900",children:i})]})]})})]})]})}function F({amount:a,currency:c,onChange:d}){return(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Amount to Send"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,b.jsx)("span",{className:"text-slate-500 font-bold",children:c})}),(0,b.jsx)(j.Input,{name:"amount",type:"number",step:"0.01",min:"0",value:a,onChange:d,required:!0,className:"pl-16 text-lg font-medium h-12 border-slate-200 focus:border-indigo-500 focus:ring-indigo-500",placeholder:"0.00"})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Source Currency"}),(0,b.jsxs)("select",{name:"currency",value:c,onChange:d,className:"w-full h-12 rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[(0,b.jsx)("option",{value:"MWK",children:"MWK (Malawian Kwacha)"}),(0,b.jsx)("option",{value:"ZMW",children:"ZMW (Zambian Kwacha)"}),(0,b.jsx)("option",{value:"CNY",children:"CNY (Chinese Yuan)"})]})]})]})}function G({targetCurrency:a,sourceCurrency:c,onChange:d}){return(0,b.jsxs)("div",{className:"space-y-3 p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Recipient Receives In"}),(0,b.jsx)("div",{className:"flex gap-4",children:["CNY","MWK","ZMW"].filter(a=>a!==c).map(c=>(0,b.jsxs)("label",{className:`
               flex-1 cursor-pointer rounded-lg border p-3 flex items-center justify-center gap-2 transition-all
               ${a===c?"bg-white border-indigo-500 shadow-sm ring-1 ring-indigo-500 text-indigo-700 font-bold":"bg-white border-slate-200 text-slate-600 hover:border-slate-300"}
             `,children:[(0,b.jsx)("input",{type:"radio",name:"targetCurrency",value:c,checked:a===c,onChange:a=>d(a.target.value),className:"hidden"}),c]},c))})]})}let H=(0,p.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var I=a.i(76249);function J({flowType:a,onChange:c}){return(0,b.jsxs)("div",{className:"flex bg-white rounded-lg p-1 border border-slate-200 shadow-sm",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>c("INTERNATIONAL"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${"INTERNATIONAL"===a?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:[(0,b.jsx)(H,{size:14,className:"inline mr-1"}),"International"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>c("SAME"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${"SAME"===a?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:[(0,b.jsx)(I.RefreshCw,{size:14,className:"inline mr-1"}),"Same Currency"]})]})}function K(){let a=e("SendMoney"),{form:c,setForm:d,targetCurrency:g,setTargetCurrency:p,flowType:v,setFlowType:w,fundingSource:x,setFundingSource:y,payoutMethod:C,setPayoutMethod:H,loading:I,error:K,result:L,setResult:M,walletBalance:N,receiverName:O,setReceiverName:P,receiverLoading:Q,suggestions:R,showSuggestions:S,setSuggestions:T,setShowSuggestions:U,previewRate:V,previewConverted:W,previewLoading:X,previewError:Y,previewFee:Z,amountNumber:$,onChange:_,onSubmit:aa}=function(a){let b=(0,s.useRouter)(),{user:c,refreshUser:d}=(0,t.useAuth)(),[e,f]=(0,r.useState)({receiver_id:"",amount:"",currency:"MWK",description:"",channel:"web",category:"transfer"}),[g,h]=(0,r.useState)("CNY"),[i,j]=(0,r.useState)("INTERNATIONAL"),[k,l]=(0,r.useState)("wallet_balance"),[m,n]=(0,r.useState)(""),[o,p]=(0,r.useState)(!1),[q,v]=(0,r.useState)(null),[w,x]=(0,r.useState)(null),[y,A]=(0,r.useState)(0),[B,C]=(0,r.useState)(null),[D,E]=(0,r.useState)(!1),[F,G]=(0,r.useState)([]),[H,I]=(0,r.useState)(!1),[J,K]=(0,r.useState)(null),[L,M]=(0,r.useState)(null),[N,O]=(0,r.useState)(!1),[P,Q]=(0,r.useState)(null),[R,S]=(0,r.useState)(null),T=(0,r.useMemo)(()=>Number(e.amount||0),[e.amount]),U=(0,r.useMemo)(()=>{let a=String(c?.countryCode||"").toUpperCase();return"CN"===a?"CNY":"MW"===a?"MWK":"ZM"===a?"ZMW":"MWK"},[c?.countryCode]),[V,W]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!V&&U&&"MWK"===e.currency&&"MWK"!==U&&(f(a=>({...a,currency:U})),W(!0))},[U,V,e.currency]),(0,r.useEffect)(()=>{(0,u.apiFetch)("/wallets").then(a=>{if(a&&a.wallets&&a.wallets.length>0){let b=a.wallets.find(a=>a.currency===e.currency)||a.wallets[0];A(parseFloat(b.available_balance||b.balance||"0"))}}).catch(()=>{})},[e.currency]),(0,r.useEffect)(()=>{let a=!0;return(async()=>{if(!e.currency||!g||!T||T<=0){K(null),M(null),Q(null);return}O(!0),Q(null);try{let b=await (0,u.apiFetch)("/forex/calculate",{method:"POST",body:JSON.stringify({from:e.currency,to:g,amount:T})}).catch(()=>null),c="number"==typeof b?.rate?b.rate:"string"==typeof b?.rate?parseFloat(b?.rate):null,d="number"==typeof b?.converted_amount?b.converted_amount:"string"==typeof b?.converted_amount?parseFloat(b.converted_amount):null,f="number"==typeof b?.fee_amount?b.fee_amount:"string"==typeof b?.fee_amount?parseFloat(b.fee_amount):null;if(!a)return;K(c),M(d??(c?T*c:null)),S(f??null)}catch(b){if(!a)return;Q(b?.message||"Failed to load rate"),K(null),M(null)}finally{if(!a)return;O(!1)}})(),()=>{a=!1}},[e.currency,g,T]),(0,r.useEffect)(()=>{let a=setTimeout(async()=>{let a=e.receiver_id.trim();if(a.length<3){G([]),I(!1),C(null);return}if(16===a.length&&/^\d+$/.test(a)){I(!1),E(!0);try{let b=await (0,u.apiFetch)(`/wallets/lookup?address=${a}`);b&&b.name?C(b.name):C(null)}catch(a){C(null)}finally{E(!1)}return}if(C(null),a.length>=3&&a.length<16){E(!0);try{let b=await (0,u.apiFetch)(`/wallets/search?q=${a}`);Array.isArray(b)&&b.length>0?(G(b),I(!0)):(G([]),I(!1))}catch(a){G([]),I(!1)}finally{E(!1)}}},400);return()=>clearTimeout(a)},[e.receiver_id]);let X=async c=>{if(c.preventDefault(),!o){p(!0),v(null),x(null);try{if(!(0,u.isAuthenticated)())throw Error("Please login to send a payment");let a=z(e.currency,y).find(a=>a.value===k),b=a?.channel||"web";if(!m)throw Error("Please select a payout method");let c={receiver_wallet_number:String(e.receiver_id||"").trim(),amount:Number(e.amount),currency:e.currency,description:e.description,channel:"mobile_money"===b?"mobile":"wallet"===b?"web":"bank"===b||"card"===b?"api":"web",category:k||e.category},f=await (0,u.apiFetch)("/payments/initiate",{method:"POST",body:JSON.stringify(c)});!f.receiver_name&&B&&(f.receiver_name=B),x(f);try{await d()}catch(a){console.warn("Failed to refresh user balance",a)}(0,u.apiFetch)("/wallets").then(a=>{if(a&&a.wallets&&a.wallets.length>0){let b=a.wallets.find(a=>a.currency===e.currency)||a.wallets[0],c=parseFloat(b.available_balance||b.balance||"0");A(c)}})}catch(e){let c=e?.data?.error||e?.message||"Payment failed",d=String(c).toLowerCase();e?.status===401||d.includes("invalid token")?(v("Please login to continue"),setTimeout(()=>b.push("/login"),600)):d.includes("duplicate request")?v(a("errors.duplicateRequest")):d.includes("insufficient balance")?v(a("errors.insufficientBalance")):v(c)}finally{p(!1)}}};return{form:e,setForm:f,targetCurrency:g,setTargetCurrency:h,flowType:i,setFlowType:j,fundingSource:k,setFundingSource:l,payoutMethod:m,setPayoutMethod:n,loading:o,error:q,result:w,setResult:x,walletBalance:y,receiverName:B,setReceiverName:C,receiverLoading:D,suggestions:F,showSuggestions:H,setSuggestions:G,setShowSuggestions:I,previewRate:J,previewConverted:L,previewLoading:N,previewError:P,previewFee:R,amountNumber:T,onChange:a=>{let{name:b,value:c}=a.target;f(a=>({...a,[b]:c}))},onSubmit:X}}(a),ab=c.currency&&g&&$>0;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(i.default,{title:a("title"),subtitle:a("subtitle"),variant:"hero"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,b.jsxs)(f.Card,{className:"border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsx)("div",{className:"bg-slate-50 border-b border-slate-100 px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 flex items-center",children:[(0,b.jsx)(m.Send,{size:20,className:"mr-2 text-indigo-600"}),a("paymentDetails")]}),(0,b.jsx)(J,{flowType:v,onChange:w})]})}),(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("form",{id:"payment-form",onSubmit:aa,className:"space-y-8",children:[(0,b.jsx)(E,{value:c.receiver_id,onChange:_,loading:Q,suggestions:R,showSuggestions:S,setShowSuggestions:U,onSelectSuggestion:a=>{d(b=>({...b,receiver_id:a})),T([]),U(!1)},receiverName:O}),(0,b.jsx)(F,{amount:c.amount,currency:c.currency,onChange:_}),"INTERNATIONAL"===v&&(0,b.jsx)(G,{targetCurrency:g,sourceCurrency:c.currency,onChange:a=>p(a)}),(0,b.jsx)(A,{currency:c.currency,walletBalance:N,value:x,onChange:y}),(0,b.jsx)(B,{targetCurrency:g,value:C,onChange:H}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-slate-700",children:"Reference / Note (Optional)"}),(0,b.jsx)(j.Input,{name:"description",value:c.description,onChange:_,placeholder:"What is this payment for?",className:"border-slate-200 h-11"})]}),(0,b.jsx)(l.Button,{type:"submit",disabled:I,className:"w-full h-12 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold text-lg shadow-lg shadow-indigo-200 transition-all !text-white",children:I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"mr-2 h-5 w-5 animate-spin"}),"Processing Securely..."]}):(0,b.jsxs)(b.Fragment,{children:["Confirm & Send Payment",(0,b.jsx)(q,{className:"ml-2 h-5 w-5"})]})})]})})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[ab&&(0,b.jsx)(h,{from:c.currency,to:g,amount:$,rate:V,converted:W,loading:X,fee:Z,error:Y}),K&&(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-start shadow-sm animate-in fade-in slide-in-from-top-2",children:[(0,b.jsx)(o.AlertCircle,{className:"h-5 w-5 mr-2 mt-0.5 shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:"Transaction Failed"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:K})]})]}),L&&(0,b.jsx)(D,{result:L,amount:$,currency:c.currency,receiverName:O,onReset:()=>{d(a=>({...a,amount:"",description:"",receiver_id:""})),M(null),P(null)}})]})]})]})}a.s(["default",()=>K],19465)}];

//# sourceMappingURL=fcc98_Projects_vaultstring-frontend_app_dashboard_send-money_page_tsx_4ade3018._.js.map