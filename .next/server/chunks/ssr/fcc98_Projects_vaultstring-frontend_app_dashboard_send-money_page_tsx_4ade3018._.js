module.exports=[19465,a=>{"use strict";var b=a.i(70839),c=a.i(16951),d=a.i(10648),e=a.i(41691);function f({fromCurrency:a,toCurrency:f,amount:g}){let[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let b=!0;return(async()=>{if(!a||!f||!g||g<=0){i(null),k(null);return}m(!0),o(null);try{let c=await (0,d.apiFetch)("/forex/calculate",{method:"POST",body:JSON.stringify({from:a,to:f,amount:g})}).catch(()=>null),e=await (0,d.apiFetch)(`/forex/rate/${a}/${f}`).catch(()=>null),h=("number"==typeof e?.buy_rate?e.buy_rate:"string"==typeof e?.buy_rate?parseFloat(e.buy_rate):null)??("number"==typeof c?.rate?c.rate:"string"==typeof c?.rate?parseFloat(c.rate):null),j="number"==typeof c?.converted_amount?c.converted_amount:"string"==typeof c?.converted_amount?parseFloat(c.converted_amount):null;if(!b)return;i(h),k(j??(h?g*h:null))}catch(a){if(!b)return;o(a?.message||"Failed to load rate"),i(null),k(null)}finally{if(!b)return;m(!1)}})(),()=>{b=!1}},[a,f,g]),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Rate Preview"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"From"}),(0,b.jsx)("span",{className:"font-semibold",children:String(a).toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"To"}),(0,b.jsx)("span",{className:"font-semibold",children:String(f).toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Buy Rate"}),(0,b.jsx)("span",{className:"font-semibold",children:l?"...":h??"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Converted Amount"}),(0,b.jsx)("span",{className:"font-semibold",children:l?"...":null!==j?`${j.toLocaleString(void 0,{maximumFractionDigits:2})} ${String(f).toUpperCase()}`:"—"})]}),n&&(0,b.jsx)("div",{className:"text-red-600 text-sm",children:n})]})})]})}var g=a.i(78807),h=a.i(60906),i=a.i(74728),j=a.i(32041),k=a.i(23723);function l(){let[a,e]=(0,c.useState)({receiver_id:"",amount:"",currency:"MWK",description:"",channel:"web",category:"transfer"}),[l,m]=(0,c.useState)("CNY"),[n,o]=(0,c.useState)("INTERNATIONAL"),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1),{user:x}=(0,k.useAuth)(),y=(0,c.useMemo)(()=>Number(a.amount||0),[a.amount]),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),N=a=>a.normalize("NFKC").replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[\u2010\u2011\u2012\u2013\u2014\u2212]/g,"-").replace(/[^0-9a-fA-F-]/g,"").trim().toLowerCase(),O=(0,c.useMemo)(()=>N(String(a.receiver_id??"")),[a.receiver_id]),P=(0,c.useMemo)(()=>"CN"===String(x?.countryCode||"").toUpperCase()?"CNY":"MWK",[x?.countryCode]),Q=(0,c.useMemo)(()=>"MWK"===a.currency?[{value:"airtel_money",label:"Airtel Money",channel:"mobile_money"},{value:"tnm_mpamba",label:"TNM Mpamba",channel:"mobile_money"},{value:"nbm",label:"National Bank of Malawi",channel:"bank"},{value:"standard_bank_mw",label:"Standard Bank Malawi",channel:"bank"},{value:"fdh_bank",label:"FDH Bank",channel:"bank"},{value:"nbs_bank",label:"NBS Bank",channel:"bank"},{value:"first_capital_bank",label:"First Capital Bank",channel:"bank"},{value:"ecobank_mw",label:"Ecobank Malawi",channel:"bank"},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card"}]:"CNY"===a.currency?[{value:"alipay",label:"Alipay",channel:"mobile_money"},{value:"wechat_pay",label:"WeChat Pay",channel:"mobile_money"},{value:"icbc",label:"ICBC",channel:"bank"},{value:"ccb",label:"China Construction Bank",channel:"bank"},{value:"boc",label:"Bank of China",channel:"bank"},{value:"abc",label:"Agricultural Bank of China",channel:"bank"},{value:"cmb",label:"China Merchants Bank",channel:"bank"},{value:"unionpay_card",label:"UnionPay Card",channel:"card"}]:[{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card"},{value:"standard_bank_intl",label:"Standard Bank (International)",channel:"bank"},{value:"ecobank_intl",label:"Ecobank (International)",channel:"bank"},{value:"wire_transfer",label:"Bank Wire Transfer",channel:"bank"}],[a.currency]),R=(0,c.useMemo)(()=>"CNY"===l?[{value:"wallet_topup_cny",label:"Wallet Top-up (CNY)",channel:"wallet"},{value:"alipay",label:"Alipay",channel:"mobile_money"},{value:"wechat_pay",label:"WeChat Pay",channel:"mobile_money"},{value:"icbc",label:"ICBC",channel:"bank"},{value:"ccb",label:"China Construction Bank",channel:"bank"},{value:"boc",label:"Bank of China",channel:"bank"},{value:"abc",label:"Agricultural Bank of China",channel:"bank"},{value:"cmb",label:"China Merchants Bank",channel:"bank"}]:"MWK"===l?[{value:"wallet_topup_mwk",label:"Wallet Top-up (MWK)",channel:"wallet"},{value:"airtel_money",label:"Airtel Money",channel:"mobile_money"},{value:"tnm_mpamba",label:"TNM Mpamba",channel:"mobile_money"},{value:"nbm",label:"National Bank of Malawi",channel:"bank"},{value:"standard_bank_mw",label:"Standard Bank Malawi",channel:"bank"},{value:"fdh_bank",label:"FDH Bank",channel:"bank"},{value:"nbs_bank",label:"NBS Bank",channel:"bank"}]:[{value:"wallet_topup_usd",label:"Wallet Top-up (USD)",channel:"wallet"},{value:"wire_transfer",label:"Bank Wire Transfer",channel:"bank"},{value:"visa_mastercard",label:"Visa/Mastercard",channel:"card"}],[l]);(0,c.useEffect)(()=>{!v&&P&&"MWK"===a.currency&&"MWK"!==P&&(e(a=>({...a,currency:P})),w(!0))},[P,v,a.currency]);let S=a=>{let{name:b,value:c}=a.target;e(a=>({...a,[b]:c}))};(0,c.useEffect)(()=>{let b=!0;return(async()=>{if(!a.currency||!l||!y||y<=0){A(null),C(null),G(null);return}E(!0),G(null);try{let c=await (0,d.apiFetch)("/forex/calculate",{method:"POST",body:JSON.stringify({from:a.currency,to:l,amount:y})}).catch(()=>null),e="number"==typeof c?.rate?c.rate:"string"==typeof c?.rate?parseFloat(c?.rate):null,f="number"==typeof c?.converted_amount?c.converted_amount:"string"==typeof c?.converted_amount?parseFloat(c.converted_amount):null,g="number"==typeof c?.fee_amount?c.fee_amount:"string"==typeof c?.fee_amount?parseFloat(c.fee_amount):null;if(!b)return;A(e),C(f??(e?y*e:null)),I(g??null)}catch(a){if(!b)return;G(a?.message||"Failed to load rate"),A(null),C(null)}finally{if(!b)return;E(!1)}})(),()=>{b=!1}},[a.currency,l,y]);let T=async b=>{b.preventDefault(),q(!0),s(null),u(null);try{if(!(0,d.isAuthenticated)())throw Error("Please login to send a payment");let b=N(String(a.receiver_id??""));if(!(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{4}-[0-9a-f]{12}$/i.test(b)||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(b)))throw Error("Wallet ID must be a valid UUID");let c=Q.find(a=>a.value===J),e=c?.channel||a.channel,f={receiver_wallet_id:b,amount:Number(a.amount),currency:a.currency,description:a.description,channel:e,category:J||a.category},g=await (0,d.apiFetch)("/payments/initiate",{method:"POST",body:JSON.stringify(f)});u(g)}catch(a){s(a?.data?.error||a?.message||"Payment failed")}finally{q(!1)}},U=a.currency&&l&&y>0;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(g.default,{title:"Send Money",subtitle:"Initiate cross-border transfers and payouts here.",variant:"hero"}),(0,b.jsxs)("form",{onSubmit:T,className:"bg-white rounded-xl border p-0 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 border-b bg-slate-50",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"How much do you want to send?"}),(0,b.jsxs)("div",{className:"mt-4 inline-flex rounded-full border bg-white",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o("INTERNATIONAL"),className:`px-4 py-2 text-sm rounded-full transition ${"INTERNATIONAL"===n?"bg-slate-900 text-white":"text-slate-600 hover:bg-slate-100"}`,children:"International"}),(0,b.jsx)("button",{type:"button",onClick:()=>o("SAME"),className:`px-4 py-2 text-sm rounded-full transition ${"SAME"===n?"bg-slate-900 text-white":"text-slate-600 hover:bg-slate-100"}`,children:"Same Currency"})]})]}),(0,b.jsxs)("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Recipient Wallet ID (UUID)"}),(0,b.jsx)(h.Input,{name:"receiver_id",value:a.receiver_id,onChange:S,placeholder:"e.g. wallet UUID",required:!0,className:"text-slate-900 placeholder:text-slate-500 bg-white",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,inputMode:"text"}),(0,b.jsxs)("div",{className:"text-xs text-slate-600",children:[(0,b.jsx)("span",{children:"Sanitized:"})," ",(0,b.jsx)("span",{className:"font-mono",children:O||"—"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"You will send"}),(0,b.jsxs)("div",{className:"mt-1 flex items-center rounded-lg border border-slate-300 bg-white overflow-hidden focus-within:ring-2 focus-within:ring-green-500",children:[(0,b.jsx)("input",{name:"amount",value:a.amount,onChange:S,type:"number",min:"0",step:"0.01",placeholder:"0.00",required:!0,className:"w-full px-4 py-3 outline-none text-slate-900 placeholder:text-slate-400"}),(0,b.jsx)("div",{className:"border-l bg-slate-50 px-3 py-3",children:(0,b.jsxs)("select",{name:"currency",value:a.currency,onChange:S,className:"bg-transparent text-slate-900",children:[(0,b.jsx)("option",{value:"MWK",children:"MWK"}),(0,b.jsx)("option",{value:"CNY",children:"CNY"}),(0,b.jsx)("option",{value:"USD",children:"USD"})]})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Recipient will get (preview)"}),(0,b.jsxs)("div",{className:"mt-1 flex items-center rounded-lg border border-slate-300 bg-white overflow-hidden focus-within:ring-2 focus-within:ring-green-500",children:[(0,b.jsx)("input",{value:null!=B?Number(B).toFixed(2):"",readOnly:!0,placeholder:"0.00",className:"w-full px-4 py-3 outline-none text-slate-900 placeholder:text-slate-400"}),(0,b.jsx)("div",{className:"border-l bg-slate-50 px-3 py-3",children:(0,b.jsxs)("select",{name:"target_currency",value:l,onChange:a=>m(a.target.value),className:"bg-transparent text-slate-900",children:[(0,b.jsx)("option",{value:"CNY",children:"CNY"}),(0,b.jsx)("option",{value:"USD",children:"USD"}),(0,b.jsx)("option",{value:"MWK",children:"MWK"})]})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Funding Source"}),(0,b.jsxs)("select",{value:J,onChange:a=>K(a.target.value),className:"mt-1 w-full border rounded-md px-3 py-2 text-slate-900 bg-white",children:[(0,b.jsx)("option",{value:"",children:"Select source"}),Q.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]})]})]}),U&&(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:(0,b.jsx)(f,{fromCurrency:a.currency,toCurrency:l,amount:y})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Payout Method"}),(0,b.jsxs)("select",{value:L,onChange:a=>M(a.target.value),className:"mt-1 w-full border rounded-md px-3 py-2 text-slate-900 bg-white",children:[(0,b.jsx)("option",{value:"",children:"Select method"}),R.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Category"}),(0,b.jsx)(h.Input,{name:"category",value:a.category,onChange:S,placeholder:"e.g. transfer",className:"text-slate-900 placeholder:text-slate-500 bg-white"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{className:"text-slate-900",children:"Description"}),(0,b.jsx)(h.Input,{name:"description",value:a.description,onChange:S,placeholder:"Payment description",className:"text-slate-900 placeholder:text-slate-500 bg-white"})]})]}),(0,b.jsxs)("div",{className:"md:col-span-1 space-y-4",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 p-4 bg-white",children:[(0,b.jsx)("div",{className:"text-sm text-slate-700 mb-2",children:"Summary"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Fees"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:null!=H?`${Number(H).toFixed(2)} ${a.currency}`:"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"You will pay"}),(0,b.jsxs)("span",{className:"font-medium text-slate-900",children:[a.amount||"0.00"," ",a.currency]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Guaranteed rate (12h)"}),(0,b.jsx)("span",{className:"font-mono text-slate-900",children:null!=z?String(z):"—"})]})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("button",{type:"button",className:"w-full text-sm text-slate-700 border rounded-md px-3 py-2 hover:bg-slate-50",children:"Set Schedule"})})]}),(0,b.jsx)(j.Button,{type:"submit",disabled:p,className:"w-full",children:p?"Processing...":"Send Payment"})]})]})]}),r&&(0,b.jsx)("div",{className:"bg-red-50 text-red-600 border border-red-200 rounded-xl p-4 max-w-xl",children:r}),t?.transaction&&(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-6 max-w-xl",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Payment Result"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Reference"}),(0,b.jsx)("span",{className:"font-mono text-slate-900",children:String(t.transaction.reference)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Status"}),(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:String(t.transaction.status)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Amount"}),(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:String(t.transaction.amount)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Currency"}),(0,b.jsx)("span",{className:"text-slate-900",children:String(t.transaction.currency)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Converted"}),(0,b.jsxs)("span",{className:"text-slate-900",children:[String(t.transaction.converted_amount)," ",String(t.transaction.converted_currency)]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Receiver Wallet ID"}),(0,b.jsx)("span",{className:"font-mono text-slate-900",children:String(t.transaction.receiver_wallet_id||"")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-slate-700",children:"Receiver User ID"}),(0,b.jsx)("span",{className:"font-mono text-slate-900",children:String(t.transaction.receiver_id||"")})]})]})]})]})}a.s(["default",()=>l],19465)}];

//# sourceMappingURL=fcc98_Projects_vaultstring-frontend_app_dashboard_send-money_page_tsx_4ade3018._.js.map